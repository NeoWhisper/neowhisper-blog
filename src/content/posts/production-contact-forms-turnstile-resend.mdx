---
title: "Building Production-Ready Contact Forms with Cloudflare Turnstile and Resend"
date: "2026-02-09"
excerpt: "Skip the spam. Skip the deliverability headaches. Here's how to build a contact form that actually works in production, using Turnstile for protection and Resend for reliable delivery."
category: "Next.js"
coverImage: "/images/contact-form-cover.png"
author:
  name: "NeoWhisper"
  picture: "/images/author.png"
---

Contact forms are supposed to be simple. Until you ship one to production.

Then the spam hits. Emails land in spam folders. Users submit blank forms. Your inbox becomes a mess of bot submissions and zero real inquiries.

I just rebuilt the [contact form](/contact) for this site, and I'm going to show you exactly how to make one that actually works. No theoretical fluff—just the patterns that matter when real users (and real bots) start hitting your form.

---

## The Problem with "Simple" Contact Forms

A basic contact form is easy to code, but it breaks in production for four critical reasons:

1. **Spam bots** will flood it within hours of launch.
2. **Email deliverability** is a nightmare (Gmail marks you as spam).
3. **No feedback** when something fails server-side.
4. **Zero progressive enhancement** (breaks without JavaScript).

<Callout type="warning">
  You need real spam protection (not a honeypot that bots bypass in 2026),
  reliable email delivery (SPF, DKIM, DMARC), and a solid UX.
</Callout>

---

## Why Cloudflare Turnstile + Resend?

**Cloudflare Turnstile** is reCAPTCHA without the Google tracking. It's invisible to most users, free for reasonable volumes, and actually stops bots.

**Resend** is the modern alternative to SendGrid/Mailgun. Clean API, excellent deliverability, and reasonable pricing.

---

<Step number="1" title="Add Turnstile to Your Form">

First, grab your Turnstile site key from [Cloudflare](https://dash.cloudflare.com/?to=/:account/turnstile).

Add it to `.env.local`:

```bash
NEXT_PUBLIC_TURNSTILE_SITE_KEY=your-site-key
TURNSTILE_SECRET_KEY=your-secret-key
```

Then add the widget to your form:

```tsx
"use client";

export default function ContactForm() {
  return (
    <form method="POST" action="/api/contact">
      <input name="name" required />
      <input name="email" type="email" required />
      <textarea name="details" required />

      {/* Turnstile Challenge */}
      <div
        className="cf-turnstile"
        data-sitekey={process.env.NEXT_PUBLIC_TURNSTILE_SITE_KEY}
      />

      <button type="submit">Send Message</button>

      <Script
        src="https://challenges.cloudflare.com/turnstile/v0/api.js"
        async
        defer
      />
    </form>
  );
}
```

</Step>

<Step number="2" title="Verify the Token Server-Side">

In your API route (`/api/contact/route.ts`), verify the token before sending any email. **Always verify server-side—client tokens can be faked.**

```tsx
export async function POST(request: Request) {
  const formData = await request.formData();
  const turnstileToken = formData.get("cf-turnstile-response");

  if (!turnstileToken) {
    return NextResponse.json(
      { ok: false, message: "Spam verification failed." },
      { status: 400 },
    );
  }

  // Verify with Cloudflare
  const verifyResponse = await fetch(
    "https://challenges.cloudflare.com/turnstile/v0/siteverify",
    {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({
        secret: process.env.TURNSTILE_SECRET_KEY,
        response: turnstileToken,
      }),
    },
  );

  const verifyData = await verifyResponse.json();

  if (!verifyData.success) {
    return NextResponse.json(
      { ok: false, message: "Spam verification failed." },
      { status: 400 },
    );
  }
}
```

</Step>

<Step number="3" title="Send Email with Resend">

Get your API key from [Resend](https://resend.com/api-keys) and send the email using their clean API:

```tsx
const emailPayload = {
  from: process.env.RESEND_FROM,
  to: [process.env.RESEND_TO],
  subject: `New inquiry from ${formData.get("name")}`,
  reply_to: formData.get("email"),
  text: `Name: ${formData.get("name")}\nEmail: ${formData.get("email")}\n\n${formData.get("details")}`,
};

const emailResponse = await fetch("https://api.resend.com/emails", {
  method: "POST",
  headers: {
    Authorization: `Bearer ${process.env.RESEND_API_KEY}`,
    "Content-Type": "application/json",
  },
  body: JSON.stringify(emailPayload),
});
```

</Step>

<Step number="4" title="Fix Email Deliverability">

Sending an email is easy. Having it land in the inbox is hard. You need three DNS records:

<Callout type="info">

**DNS Requirements:**

- **SPF:** `v=spf1 include:_spf.resend.com ~all`
- **DKIM:** Generated in your Resend dashboard.
- **DMARC:** `v=DMARC1; p=quarantine; rua=mailto:postmaster@yourdomain.com; pct=100; adkim=s; aspf=s`

</Callout>

Without these, Gmail/Outlook will mark your emails as spam or reject them entirely. I learned this the hard way—our [contact form](/contact) wasn't working for weeks until we added DMARC.

</Step>

<Step number="5" title="Advanced UI & UX">

### Progressive Enhancement

Your form should work even if JavaScript fails to load. Use the platform by detecting the content type in your API route:

```tsx
const contentType = request.headers.get("content-type") ?? "";
const isFormSubmit = contentType.includes("application/x-www-form-urlencoded");

if (isFormSubmit) {
  return NextResponse.redirect(new URL("/contact?success=1", request.url), 303);
}
```

### Specific Error Handling

Don't just return generic messages. Be specific about what went wrong (Missing fields, invalid email, security check failed) to help the user fix it.

</Step>

---

## Final Checklist

<Checklist>
  <CheckItem>
    Test Turnstile with and without completing the challenge
  </CheckItem>
  <CheckItem>Verify all DNS records (SPF/DKIM/DMARC) using MXToolbox</CheckItem>
  <CheckItem>Test deliverability to Gmail, Outlook, and Yahoo</CheckItem>
  <CheckItem>
    Disable JavaScript and ensure the form still submits correctly
  </CheckItem>
  <CheckItem>Check server logs for any uncaught Resend API errors</CheckItem>
</Checklist>

---

**Need help building a production-ready contact form for your site?** We specialize in Next.js development with all the details handled—from spam protection to email deliverability. Check out our [services](/services) or [get in touch](/contact) to discuss your project.

---

**Related:** If you're building multilingual sites, check out our guide on [shipping AdSense-ready Next.js sites](/blog/adsense-ready-multilingual-nextjs) with proper localization.
